
---
  test_name: Hivemind bridge_api.get_post_header not existing permlink patterns test
      # not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge
  marks:
    - patterntest # original gives no error, just no result

  includes:
    - !include common.yaml

  stages:
    - name: get_post_header gtg
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_post_header"
          params: {"author":"gtg", "permlink":"not_existing_permlink"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_post_header_not_existing_permlink"
            directory: "bridge_api_patterns_error"
            error_response: true
            ignore_tags: ["timestamp"]

---
  test_name: Hivemind bridge_api.get_discussion non existing permlink patterns test
      # not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge
  marks:
    - patterntest


  includes:
    - !include common.yaml

  stages:
    - name: get_discussion
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_discussion"
          params: {"author":"gtg", "permlink":"not_existing_permlink"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_discussion_not_existing_permlink"
            directory: "bridge_api_patterns_error"

---
  test_name: Hivemind bridge_api.get_ranked_posts sort invalid patterns test

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_ranked_posts sort invalid
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_ranked_posts"
          params: {"sort":"invalid_sort","tag":"","observer":"steemit"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_ranked_posts_invalid_sort"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_profile not existing patterns test
      #not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge
  marks:
    - patterntest # original gives no error, just no result

  includes:
    - !include common.yaml

  stages:
    - name: get_profile gtg
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_profile"
          params: {"account":"not.existing"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_profile_not_existing_account"
            directory: "bridge_api_patterns_error"
            error_response: true
            ignore_tags: ["timestamp"]

---
  test_name: Hivemind bridge_api.get_profile patterns test
  #not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge

  marks:
    - patterntest # original gives no error, just no result
  
  includes:
    - !include common.yaml

  stages:
    - name: get_profile
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_profile"
          params: {"account":"468"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_profile_number_account"
            directory: "bridge_api_patterns_error"
            error_response: true
            ignore_tags: ["timestamp"]

---
  test_name: Hivemind bridge_api.get_trending_topics patterns over limit test

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_trending_topics over limit
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_trending_topics"
          params: {"limit": 26}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_trending_topics_over_limit"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_trending_topics patterns over limit test
  # not documented
  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_trending_topics over limit
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_trending_topics"
          params: {"limit": "-7"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_trending_topics_negative_limit"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_payout_stats over limit test
      # not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge
  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_payout_stats over limit
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_payout_stats"
          params: {"limit": 251}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_payout_stats_over_limit"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_community patterns test
      # not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge
  marks:
    - patterntest # communities do not exist in first 5mln, so only error response is possible

  includes:
    - !include common.yaml

  stages:
    - name: get_community
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_community"
          params: {"name":"hive-123456", "observer":"steemit"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_community"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_all_subscriptions patterns test wrong account

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: list_all_subscriptions
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_all_subscriptions"
          params: {"account":"wyuh"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_all_subscriptions_wrong_account_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_all_subscriptions patterns test wrong account

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: list_all_subscriptions
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_all_subscriptions"
          params: {"account":""}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_all_subscriptions_wrong_account_error_v2"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_all_subscriptions patterns test wrong account

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: list_all_subscriptions
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_all_subscriptions"
          params: {"test":"gtg"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_all_subscriptions_wrong_account_error_v3"
            directory: "bridge_api_patterns_error"
            error_response: true


---
  test_name: Hivemind bridge_api.list_subscribers patterns test # not documented
  marks:
    - patterntest # no nonempty result possible for 5mln set

  includes:
    - !include common.yaml

  stages:
    - name: list_subscribers
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_subscribers"
          params: []
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_subscribers_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_subscribers patterns test # not documented 

  marks:
    - patterntest # error should be generated here, but we get empty result (like in original)

  includes:
    - !include common.yaml

  stages:
    - name: list_subscribers
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_subscribers"
          params: ['789']
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_subscribers_account_error"
            directory: "bridge_api_patterns_error"

---
  test_name: Hivemind bridge_api.list_subscribers patterns test # not documented
  marks:
    - patterntest # change to proper error, missing check on type of argument

  includes:
    - !include common.yaml

  stages:
    - name: list_subscribers
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_subscribers"
          params: [789]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_subscribers_account_error_v2"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_payout_stats patterns test 10

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_payout_stats
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_payout_stats"
          params: [-1]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_payout_stats_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_payout_stats patterns test 10

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_payout_stats
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_payout_stats"
          params: ["10", ""]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_payout_stats_error_v2"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_payout_stats patterns test 10

  marks:
    - patterntest # it should be changed to proper error, currrent server error is barely acceptable in that case

  includes:
    - !include common.yaml

  stages:
    - name: get_payout_stats
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_payout_stats"
          params: [""]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_payout_stats_empty_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge.post_notifications patterns test
    # author and permlink must be both to find post id

  marks:
    - patterntest # maybe post 'steemit/' not found would be better

  includes:
    - !include common.yaml

  stages:
    - name: post_notifications
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.post_notifications"
          params: ["steemit","", ""]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "post_notifications_author_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.post_notifications patterns test

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: post_notifications
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.post_notifications"
          params: [""]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "post_notifications_empty_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_pop_communities patterns test # 8080
  # not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge
  # no nonempty result possible for 5mln set

  marks:
    - patterntest # change to proper error, server error is barely acceptable here


  includes:
    - !include common.yaml

  stages:
    - name: list_pop_communities
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_pop_communities"
          params: ["steemit"]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_pop_communities_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_pop_communities patterns test # 8080 023

  marks:
    - patterntest # change to proper error, server error is barely acceptable here

  includes:
    - !include common.yaml

  stages:
    - name: list_pop_communities
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_pop_communities"
          params: [""]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_pop_communities_empty_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_pop_communities patterns test # 8080

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: list_pop_communities
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_pop_communities"
          params: ["", "1"]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_pop_communities_to_many_args_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_pop_communities patterns test # 8080

  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: list_pop_communities
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_pop_communities"
          params: [77]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_pop_communities_limit_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.list_pop_communities patterns test # 8080

  marks:
    - patterntest # change to proper error, server error is barely acceptable here

  includes:
    - !include common.yaml

  stages:
    - name: list_pop_communities
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.list_pop_communities"
          params: ["25"]
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "list_pop_communities_server_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_community_context patterns test # 8080
    # not documented on https://developers.hive.io/apidefinitions/#apidefinitions-bridge
    # no communities for 5mln set
  
  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_community_context
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_community_context"
          params: {"account": "steemit","name": "Hive Gaming"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_community_context_community_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_relationship_between_accounts patterns test # 8080
  
  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: get_relationship_between_accounts
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_relationship_between_accounts"
          params: {"account1": "tinfoilfedora"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_relationship_between_accounts_error"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge.post_notifications patterns test no parames # openapi bc there is no notifs in 5mln set

  # post_notifications(context, author, permlink, min_score=25, last_id=None, limit=100) last_id - notification id
  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: bridge.post_notifications
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.post_notifications"
          params: {}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "post_notifications_empty_params"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge.post_notifications patterns test only account # openapi
  marks:
    - patterntest

  includes:
    - !include common.yaml

  stages:
    - name: bridge.post_notifications
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.post_notifications"
          params: {"author":"acidyo"}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "post_notifications_only_account"
            directory: "bridge_api_patterns_error"
            error_response: true

---
  test_name: Hivemind bridge_api.get_profile empty params
  marks:
    - patterntest

  includes:
    - !include common.yaml
  stages:
    - name: get_profile
      request:
        url: "{service.proto:s}://{service.server:s}:{service.port}/"
        method: POST
        headers:
          content-type: application/json
        json:
          jsonrpc: "2.0"
          id: 1
          method: "bridge.get_profile"
          params: {}
      response:
        status_code: 200
        verify_response_with:
          function: validate_response:compare_response_with_pattern
          extra_kwargs:
            method: "get_profile_empty_error"
            directory: "bridge_api_patterns_error"
            error_response: true
